(this["webpackJsonpvideo-labeller"]=this["webpackJsonpvideo-labeller"]||[]).push([[0],{157:function(e,t,n){e.exports=n(243)},170:function(e,t,n){},171:function(e,t,n){},172:function(e,t,n){},173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},176:function(e,t,n){},178:function(e,t,n){},179:function(e,t,n){},238:function(e,t,n){},239:function(e,t,n){var a={"./corgi_demo.mp4":240,"./pomsky_demo.mp4":241};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=239},240:function(e,t,n){e.exports=n.p+"static/media/corgi_demo.1d358d7f.mp4"},241:function(e,t,n){e.exports=n.p+"static/media/pomsky_demo.06c48d11.mp4"},243:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),i=n.n(o),l=n(107),c=n(23),u=n(137),d=n(31),s=n(86),m=n(151),E=(n(166),n(109)),p=n.n(E),v=n(152),f=p.a.mark(b);function b(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.a)([]);case 2:case"end":return e.stop()}}),f)}var O=n(138),T=n.n(O),y=n(139),h=n.n(y),g=n(15),j={SET_CURRENT_VIDEO:"SET_CURRENT_VIDEO",UPDATE_TIME:"UPDATE_TIME",SET_CURRENT_VIDEO_ELEMENT:"SET_CURRENT_VIDEO_ELEMENT"},N=[{name:"corgi_demo.mp4",totalFrames:1801,duration:60.094},{name:"pomsky_demo.mp4",totalFrames:555,duration:23.151}],_={videosList:N,currentVideo:Object(g.a)(Object(g.a)({},N[0]),{},{time:0}),videoElement:null},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j.SET_CURRENT_VIDEO:return Object(g.a)(Object(g.a)({},e),{},{currentVideo:t.payload});case j.UPDATE_TIME:return Object(g.a)(Object(g.a)({},e),{},{currentVideo:Object(g.a)(Object(g.a)({},e.currentVideo),{},{time:t.payload})});case j.SET_CURRENT_VIDEO_ELEMENT:return Object(g.a)(Object(g.a)({},e),{},{videoElement:t.payload});default:return e}},A={ADD_ANNOTATION:"ADD_ANNOTATION",CLEAR_ANNOTATIONS:"CLEAR_ANNOTATIONS",DELETE_ANNOTATION:"DELETE_ANNOTATION"},k=n(29),L=function(e,t){var n=t.label,a=t.currentVideo,r=a.name,o=a.time,i=a.duration,l=a.totalFrames,c=Math.round(o/i*l),u={label:n,name:r,frame:c},d=e.find((function(e){return e.name===r&&e.label===n&&e.frame===c}));if(d)return{lastLabelled:d,data:e};var s=[].concat(Object(k.a)(e),[u]);return s.sort((function(e,t){return t.frame-e.frame})),{lastLabelled:u,data:s}},D=function(e,t){var n=t.name,a=t.label,r=t.frame;return e.filter((function(e){return e.name!==n||e.label!==a||e.frame!==r}))},w={labels:["start walk","end walk","start cute","end cute"],data:[],lastLabelled:null},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A.ADD_ANNOTATION:var n=L(e.data,t.payload),a=n.data,r=n.lastLabelled;return Object(g.a)(Object(g.a)({},e),{},{data:a,lastLabelled:r});case A.CLEAR_ANNOTATIONS:return Object(g.a)(Object(g.a)({},e),{},{data:[]});case A.DELETE_ANNOTATION:return Object(g.a)(Object(g.a)({},e),{},{data:D(e.data,t.payload)});default:return e}},S={key:"root",storage:T.a,whitelist:["annotation"],stateReconciler:h.a},I=Object(d.c)({videos:C,annotation:V}),R=Object(s.a)(S,I),M=Object(m.a)(),U=[M];var x=Object(d.e)(R,d.a.apply(void 0,U)),F=Object(s.b)(x);M.run(b);n(170),n(171);var P=n(46),B=(n(172),n(32)),W=(n(173),n(20)),J=function(e){return e.videos},K=Object(W.a)([J],(function(e){return e.videosList})),q=Object(W.a)([J],(function(e){return e.currentVideo})),H=Object(W.a)([q],(function(e){return e.duration/e.totalFrames})),$=Object(W.a)([J],(function(e){return e.videoElement})),z=n(278),G=n(57),Q=n(38),X=n(88),Y=n(87),Z=(n(174),function(e){Object(X.a)(n,e);var t=Object(Y.a)(n);function n(e){var a;return Object(G.a)(this,n),(a=t.call(this,e)).videoElement=r.a.createRef(),a}return Object(Q.a)(n,[{key:"componentDidMount",value:function(){this.props.setCurrentVideoElement(this.videoElement.current)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"video-display__video-container"},r.a.createElement("video",{src:this.props.video,ref:this.videoElement,id:"video"})))}}]),n}(r.a.Component)),ee=Object(c.b)(null,(function(e){return{setCurrentVideoElement:function(t){return e(function(e){return{type:j.SET_CURRENT_VIDEO_ELEMENT,payload:e}}(t))}}}))(Z),te=n(273),ne=n(144),ae=n.n(ne),re=n(143),oe=n.n(re),ie=n(282),le=(n(175),Object(W.b)({currentVideo:q})),ce=Object(c.b)(le)((function(e){var t=e.videoElement,n=e.currentVideo,o=e.callback,i=Object(a.useState)(0),l=Object(B.a)(i,2),c=l[0],u=l[1];Object(a.useEffect)((function(){u(n.time/n.duration*100)}),[n]);return r.a.createElement("div",{className:"video-slider"},r.a.createElement("div",null,r.a.createElement("p",{className:"frame-counter"},"frame: ",Math.round(c/100*n.totalFrames))),r.a.createElement(ie.a,{value:c,onChange:function(e,n){t.pause(),u(n)},onChangeCommitted:function(){document.activeElement.blur(),t.currentTime=c/100*n.duration,o()},className:"video-slider__slider"}))})),ue=(n(176),function(e){Object(X.a)(n,e);var t=Object(Y.a)(n);function n(e){var a;return Object(G.a)(this,n),(a=t.call(this,e)).addListeners=function(e){e.addEventListener("timeupdate",a.handleTimeUpdate,!1),e.addEventListener("ended",a.onVideoEnd,!1),document.addEventListener("keydown",a.handleKeyDown,!1)},a.removeListeners=function(e){e.removeEventListener("timeupdate",a.handleTimeUpdate,!1),e.removeEventListener("ended",a.onVideoEnd,!1),document.removeEventListener("keydown",a.handleKeyDown,!1)},a.onVideoEnd=function(){a.setState(Object(g.a)(Object(g.a)({},a.state),{},{playing:!1}))},a.handleTimeUpdate=function(){(0,a.props.updateTime)(a.props.videoElement.currentTime)},a.changeTime=function(e){a.props.videoElement.currentTime=e<0?Math.max(a.props.videoElement.currentTime+e,0):Math.min(a.props.videoElement.currentTime+e,a.props.videoElement.duration)},a.handleKeyDown=function(e){if(e.preventDefault(),document.activeElement.blur(),a.canMove){var t=a.props.frameTime;a.canMove=!1,setTimeout((function(){return a.canMove=!0}),100);var n=e.keyCode;switch(console.log("keycode: ",n),n){case 32:case 38:case 40:return a.togglePlaying();case 37:return void(a.props.videoElement.currentTime=Math.max(a.props.videoElement.currentTime-t,0));case 39:return void(a.props.videoElement.currentTime=Math.min(a.props.videoElement.currentTime+t,a.props.videoElement.duration));default:return}}},a.pauseVideo=function(){a.props.videoElement.pause(),a.setState(Object(g.a)(Object(g.a)({},a.state),{},{playing:!1}))},a.playVideo=function(){a.props.videoElement.play(),a.setState(Object(g.a)(Object(g.a)({},a.state),{},{playing:!0}))},a.togglePlaying=function(){a.props.videoElement.playing?a.pauseVideo():a.playVideo()},a.handleSliderChange=function(){a.state.playing?a.props.videoElement.play():a.props.videoElement.pause()},a.logCurrentState=function(){console.log("paused? ",a.props.videoElement.paused),console.log("time: ",a.props.videoElement.currentTime),console.log("has ended?: ",a.props.videoElement.ended),console.log("playing?: ",a.props.videoElement.playing),console.log("duration",a.props.videoElement.duration),alert("\n    paused: ".concat(a.props.videoElement.paused,"\n    time: ").concat(a.props.videoElement.currentTime,"\n    hasEnded: ").concat(a.props.videoElement.ended,"\n    playing: ").concat(a.props.videoElement.playing,"\n    duration: ").concat(a.props.videoElement.duration,"\n    "))},a.canMove=!0,a.state={playing:!1},a}return Object(Q.a)(n,[{key:"componentDidUpdate",value:function(e){e.videoElement!==this.props.videoElement&&(e.videoElement&&this.removeListeners(e.videoElement),this.props.videoElement&&this.addListeners(this.props.videoElement))}},{key:"componentWillUnmount",value:function(){this.props.videoElement&&this.removeListeners(this.props.videoElement)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.props.videoElement?r.a.createElement("div",null,r.a.createElement("div",{className:"video-controller__controls"},r.a.createElement(te.a,{onClick:this.logCurrentState,variant:"contained",className:" video-controller__btn"},"Video Details"),r.a.createElement(te.a,{onClick:function(){return e.changeTime(10*-e.props.frameTime)},variant:"contained",className:" video-controller__btn"},"Back"),r.a.createElement(te.a,{onClick:this.togglePlaying,className:"video-controller__play-button video-controller__btn",variant:"contained"},this.state.playing?r.a.createElement(oe.a,null):r.a.createElement(ae.a,null)),r.a.createElement(te.a,{onClick:function(){return e.changeTime(10*e.props.frameTime)},variant:"contained",className:" video-controller__btn"},"Forward")),r.a.createElement(ce,{videoElement:this.props.videoElement,callback:this.handleSliderChange})):r.a.createElement("h1",null,"test"))}}]),n}(r.a.Component)),de=Object(W.b)({frameTime:H,videoElement:$}),se=Object(c.b)(de,(function(e){return{updateTime:function(t){return e(function(e){return{type:j.UPDATE_TIME,payload:e}}(t))}}}))(ue),me=Object(W.b)({currentVideo:q}),Ee=Object(c.b)(me,(function(e){return{addAnnotation:function(t,n){return e(function(e,t){return{type:A.ADD_ANNOTATION,payload:{label:e,currentVideo:t}}}(t,n))}}}))((function(e){var t=e.label,n=e.currentVideo,a=e.addAnnotation;return r.a.createElement("div",null,r.a.createElement(te.a,{onClick:function(){a(t,n)},variant:"contained",color:"default"},t))})),pe=n(281),ve=n(277),fe=n(275),be=n(276),Oe=n(274),Te=(n(178),function(e){var t=e.label,n=e.callback,a=r.a.useState(!1),o=Object(B.a)(a,2),i=o[0],l=o[1],c=function(){l(!1)};return r.a.createElement("div",null,r.a.createElement(te.a,{onClick:function(){l(!0)},className:"alert-button",variant:"contained"},t),r.a.createElement(pe.a,{open:i,onClose:c,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(Oe.a,{id:"alert-dialog-title"}),r.a.createElement(fe.a,null,r.a.createElement(be.a,{id:"alert-dialog-description"},"Are you sure you want to continue?")),r.a.createElement(ve.a,null,r.a.createElement(te.a,{onClick:c,color:"primary"},"Cancel"),r.a.createElement(te.a,{onClick:function(){c(),n()},color:"primary",autoFocus:!0},"Continue"))))}),ye=function(e){return e.annotation},he=Object(W.a)([ye],(function(e){return e.labels})),ge=Object(W.a)([ye],(function(e){return e.data})),je=Object(W.a)([ye],(function(e){return e.lastLabelled})),Ne=(n(179),Object(W.b)({labels:he})),_e=Object(c.b)(Ne,(function(e){return{clearAnnotations:function(){return e({type:A.CLEAR_ANNOTATIONS})}}}))((function(e){var t=e.labels,n=e.clearAnnotations;return r.a.createElement("div",{className:"label-buttons-container"},r.a.createElement(z.a,{container:!0,justify:"flex-start",spacing:2},t.map((function(e,t){return r.a.createElement(z.a,{item:!0,xs:4,lg:3,key:t},r.a.createElement(Ee,{label:e}))})),r.a.createElement(z.a,{item:!0,xs:4,lg:3},r.a.createElement(Te,{callback:n,label:"Clear"}))))})),Ce=n(112),Ae=n(283),ke=n(279),Le=n(280),De=n(149),we=n.n(De),Ve=Object(c.b)(null,(function(e){return{deleteAnnotation:function(t){return e(function(e){return{type:A.DELETE_ANNOTATION,payload:e}}(t))}}}))((function(e){var t=e.annotation,n=e.isTarget,o=e.deleteAnnotation,i=e.style,l=Object(a.useState)(!1),c=Object(B.a)(l,2),u=c[0],d=c[1],s=Object(a.useState)(!1),m=Object(B.a)(s,2),E=m[0],p=m[1];Object(a.useEffect)((function(){p(!0),setTimeout((function(){return p(!1)}),500)}),[t]);var v=t.label,f=t.frame;return r.a.createElement("div",{style:i,id:n?"last-labelled":null,className:"annotations-list__item-container ".concat(u?"pending-deletion":null," ").concat(E?"animate":null)},r.a.createElement(Ae.a,{className:"annotations-list__item"},r.a.createElement(ke.a,{primary:v,secondary:"frame: ".concat(f)}),r.a.createElement(Le.a,{onClick:function(e){u||(d(!0),setTimeout((function(){o(t)}),300))},edge:"end","aria-label":"delete"},r.a.createElement(we.a,{className:"delete-button"}))))})),Se=(n(238),Object(W.b)({annotations:ge,lastLabelled:je})),Ie=Object(c.b)(Se)((function(e){var t=e.annotations,n=e.lastLabelled;Object(a.useEffect)((function(){var e=document.querySelector(".annotations-list"),t=document.querySelector("#last-labelled");t&&(e.scrollTop=t.offsetTop-20)}),[n]);var o=function(e){var a,o,i=e.index,l=e.style;return r.a.createElement(Ve,{key:Math.random(),style:l,annotation:t[i],isTarget:(a=t[i],o=n,!!o&&a.name===o.name&&a.frame===o.frame&&a.label===o.label)})};return r.a.createElement("div",null,r.a.createElement("div",{className:"annotations-list"},r.a.createElement(Ce.a,null,(function(e){var n=e.height,a=e.width;return r.a.createElement(Ce.b,{ref:"List",height:n,width:a,rowHeight:64,rowRenderer:o,rowCount:t.length})}))),r.a.createElement(te.a,{onClick:function(){var e=JSON.stringify(t),n=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(n),r=document.createElement("a");r.download="file.json",document.body.appendChild(r),r.href=a,r.click(),document.body.removeChild(r)}},"Save Data"))})),Re=function(){return r.a.createElement("div",null,r.a.createElement(z.a,{container:!0,direction:"column",justify:"space-between"},r.a.createElement(z.a,{item:!0,xs:12},r.a.createElement(Ie,null)),r.a.createElement(z.a,{item:!0,xs:12},r.a.createElement(_e,null))))},Me=Object(W.b)({videosList:K}),Ue=Object(c.b)(Me,(function(e){return{setCurrentVideo:function(t){return e(function(e){return{type:j.SET_CURRENT_VIDEO,payload:e}}(t))}}}))((function(e){var t=e.videosList,o=(e.setCurrentVideo,Object(a.useState)(0)),i=Object(B.a)(o,2),l=i[0],c=(i[1],t[l]),u=n(239)("./".concat(c.name));return r.a.createElement("div",{className:"labelling-page"},r.a.createElement(z.a,{container:!0,spacing:3,alignItems:"center"},r.a.createElement(z.a,{item:!0,xs:12,md:7},r.a.createElement(ee,{video:u}),r.a.createElement("div",{style:{margin:".5rem"}},"Use \u2190 and \u2192 to change frames."),r.a.createElement("div",{className:"labelling-page__video-controller"},r.a.createElement(se,null))),r.a.createElement(z.a,{item:!0,xs:12,md:5},r.a.createElement(Re,null))))}));var xe=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(P.c,null,r.a.createElement(P.a,{path:"/",component:Ue})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object.defineProperty(HTMLMediaElement.prototype,"playing",{get:function(){return!!(this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2)}}),i.a.render(r.a.createElement(c.a,{store:x},r.a.createElement(u.a,{persistor:F},r.a.createElement(l.a,null,r.a.createElement(xe,null),r.a.createElement(te.a,{style:{margin:"1rem"},onClick:function(){return F.purge()},variant:"contained"},"Wipe Storage")))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[157,1,2]]]);
//# sourceMappingURL=main.4a3f98a0.chunk.js.map